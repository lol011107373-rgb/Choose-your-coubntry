<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CPA Offers</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg: #f7fafc;
      --card: #ffffff;
      --text: #0f172a;
      --muted: #64748b;
      --pastel: #dbeafe;
      --pastel-hover: #bfdbfe;
      --accent: #94a3b8;
      --radius: 18px;
      --shadow: 0 10px 30px rgba(2, 6, 23, .08);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:"Cairo", system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
      background:
        radial-gradient(1200px 600px at 100% -20%, #eef2ff 10%, transparent 60%),
        radial-gradient(1000px 600px at -10% 120%, #f0f9ff 10%, transparent 60%),
        var(--bg);
      color:var(--text);
      min-height:100dvh;
      display:flex; align-items:center; justify-content:center;
      padding:24px;
    }
    .wrap{ width:100%; max-width:780px; }
    .card{
      background:var(--card);
      border-radius:calc(var(--radius) + 6px);
      box-shadow:var(--shadow);
      padding:28px;
      border:1px solid #e2e8f0;
    }
    header{text-align:center; margin-bottom:20px;}
    h1{ margin:0 0 8px 0; font-size:clamp(22px, 4.2vw, 34px); font-weight:800; }
    p.lead{ margin:0 auto 6px; color:var(--muted); font-size:clamp(14px, 2.8vw, 16px); }
    .grid{ display:grid; grid-template-columns:repeat(1, 1fr); gap:12px; margin-top:16px; }
    @media (min-width:520px){ .grid{ grid-template-columns:repeat(2, 1fr);} }
    @media (min-width:860px){ .grid{ grid-template-columns:repeat(3, 1fr);} }
    a.btn{
      display:flex; align-items:center; justify-content:flex-start;
      gap:10px;
      text-decoration:none;
      background:var(--pastel);
      padding:14px 16px;
      border-radius:var(--radius);
      border:1px solid #c7d2fe;
      transition:transform .08s ease, background .15s ease, border-color .15s ease, box-shadow .15s ease;
      color:#0b1324;
      font-weight:700;
      letter-spacing:.2px;
      box-shadow:0 4px 14px rgba(15, 23, 42, .06);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    a.btn:hover{ background:var(--pastel-hover); border-color:#a5b4fc; transform:translateY(-1px) }
    a.btn:active{ transform:translateY(0) scale(.99) }
    .flag{ font-size:18px; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <header>
        <h1>Available Offers</h1>
        <p class="lead">Choose your offer below</p>
      </header>
      <div id="offers" class="grid"></div>
    </div>
  </div>

  <script>
    // Country code to name map
    const countryMap = {
      US: "United States", FR: "France", PT: "Portugal", TW: "Taiwan", IL: "Israel",
      MD: "Moldova", AR: "Argentina", SA: "Saudi Arabia", NZ: "New Zealand", CA: "Canada",
      CM: "Cameroon", GB: "United Kingdom", CR: "Costa Rica", LK: "Sri Lanka", LU: "Luxembourg",
      ES: "Spain", SR: "Suriname", ZA: "South Africa", MX: "Mexico", CI: "Ivory Coast",
      PS: "Palestine", TR: "Turkey", CL: "Chile", IQ: "Iraq", VN: "Vietnam", AL: "Albania",
      BD: "Bangladesh", TN: "Tunisia", MA: "Morocco", CO: "Colombia", AM: "Armenia",
      NG: "Nigeria", RO: "Romania", EG: "Egypt", NP: "Nepal", AT: "Austria", PK: "Pakistan",
      LY: "Libya", VE: "Venezuela", PH: "Philippines", RU: "Russia", KR: "South Korea",
      JM: "Jamaica", BZ: "Belize", HN: "Honduras", MG: "Madagascar", UG: "Uganda", MY: "Malaysia",
      LB: "Lebanon"
    };

    // Convert country code -> emoji flag
    function codeToFlag(code) {
      if (!code) return "";
      return code.toUpperCase().replace(/./g, c => 
        String.fromCodePoint(127397 + c.charCodeAt())
      );
    }

    // Load JSON
    fetch("csvjson.json")
      .then(res => res.json())
      .then(data => {
        const offersDiv = document.getElementById("offers");
        const grouped = {};

        data.forEach(offer => {
          const countryName = countryMap[offer.country_codes] || offer.country_codes;
          const flag = codeToFlag(offer.country_codes);
          const os = offer.device_type || "Unknown";
          const key = countryName + " - " + os;

          if (!grouped[key]) grouped[key] = [];
          grouped[key].push({ ...offer, flag, countryName, os });
        });

        // Sort countries alphabetically
        Object.keys(grouped)
          .sort((a, b) => a.localeCompare(b))
          .forEach(key => {
            grouped[key].forEach((offer, index) => {
              const btn = document.createElement("a");
              btn.className = "btn";
              btn.href = offer.offer_url;
              btn.target = "_blank";
              btn.innerHTML = `<span class="flag">${offer.flag}</span> ${offer.countryName} (${offer.os}) (${index+1})`;
              offersDiv.appendChild(btn);
            });
          });
      });
  </script>
</body>
</html>
