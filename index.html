<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CPA Offers</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg: #f7fafc;
      --card: #ffffff;
      --text: #0f172a;
      --muted: #64748b;
      --pastel: #dbeafe;
      --pastel-hover: #bfdbfe;
      --accent: #94a3b8;
      --radius: 18px;
      --shadow: 0 10px 30px rgba(2, 6, 23, .08);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:"Cairo", system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
      background:
        radial-gradient(1200px 600px at 100% -20%, #eef2ff 10%, transparent 60%),
        radial-gradient(1000px 600px at -10% 120%, #f0f9ff 10%, transparent 60%),
        var(--bg);
      color:var(--text);
      min-height:100dvh;
      display:flex; align-items:flex-start; justify-content:center;
      padding:24px;
    }
    .wrap{ width:100%; max-width:780px; }
    .card{
      background:var(--card);
      border-radius:calc(var(--radius) + 6px);
      box-shadow:var(--shadow);
      padding:28px;
      border:1px solid #e2e8f0;
      position:relative;
    }
    header{
      display:flex; justify-content:space-between; align-items:center;
      margin-bottom:20px;
    }
    h1{ margin:0; font-size:clamp(22px, 4.2vw, 34px); font-weight:800; }
    .search-box{
      position:relative;
      max-width:250px;
      width:100%;
    }
    .search-input{
      width:100%;
      padding:10px 12px;
      border-radius:8px;
      border:1px solid #c7d2fe;
      background:var(--pastel);
      font-size:14px;
    }
    .autocomplete-list{
      position:absolute;
      top:100%;
      left:0;
      right:0;
      background:white;
      border:1px solid #c7d2fe;
      border-radius:8px;
      box-shadow:var(--shadow);
      max-height:200px;
      overflow-y:auto;
      z-index:1000;
    }
    .autocomplete-item{
      padding:10px;
      cursor:pointer;
    }
    .autocomplete-item:hover{
      background:var(--pastel-hover);
    }
    .grid{ display:grid; grid-template-columns:repeat(1, 1fr); gap:12px; margin-top:16px; }
    @media (min-width:520px){ .grid{ grid-template-columns:repeat(2, 1fr);} }
    @media (min-width:860px){ .grid{ grid-template-columns:repeat(3, 1fr);} }
    a.btn{
      display:flex; align-items:center; justify-content:flex-start;
      gap:10px;
      text-decoration:none;
      background:var(--pastel);
      padding:14px 16px;
      border-radius:var(--radius);
      border:1px solid #c7d2fe;
      transition:transform .08s ease, background .15s ease, border-color .15s ease, box-shadow .15s ease;
      color:#0b1324;
      font-weight:700;
      letter-spacing:.2px;
      box-shadow:0 4px 14px rgba(15, 23, 42, .06);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    a.btn:hover{ background:var(--pastel-hover); border-color:#a5b4fc; transform:translateY(-1px) }
    a.btn:active{ transform:translateY(0) scale(.99) }
    .flag{ font-size:18px; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <header>
        <h1>Do Offers To Win Prizes</h1>
        <div class="search-box">
          <input type="text" id="search" class="search-input" placeholder="Search country...">
          <div id="autocomplete" class="autocomplete-list" style="display:none;"></div>
        </div>
      </header>
      <div id="offers" class="grid"></div>
    </div>
  </div>

  <script>
    const countryMap = {
      AD: "Andorra", AE: "UAE", AF: "Afghanistan", AG: "Antigua", AI: "Anguilla",
      AL: "Albania", AM: "Armenia", AO: "Angola", AQ: "Antarctica", AR: "Argentina",
      AS: "American Samoa", AT: "Austria", AU: "Australia", AW: "Aruba", AX: "Åland",
      AZ: "Azerbaijan", BA: "Bosnia", BB: "Barbados", BD: "Bangladesh", BE: "Belgium",
      BF: "Burkina Faso", BG: "Bulgaria", BH: "Bahrain", BI: "Burundi", BJ: "Benin",
      BL: "Saint Barthélemy", BM: "Bermuda", BN: "Brunei", BO: "Bolivia", BQ: "Caribbean Netherlands",
      BR: "Brazil", BS: "Bahamas", BT: "Bhutan", BV: "Bouvet Island", BW: "Botswana",
      BY: "Belarus", BZ: "Belize", CA: "Canada", CC: "Cocos Islands", CD: "DR Congo",
      CF: "Central African Republic", CG: "Congo", CH: "Switzerland", CI: "Ivory Coast",
      CK: "Cook Islands", CL: "Chile", CM: "Cameroon", CN: "China", CO: "Colombia",
      CR: "Costa Rica", CU: "Cuba", CV: "Cape Verde", CW: "Curaçao", CX: "Christmas Island",
      CY: "Cyprus", CZ: "Czech Republic", DE: "Germany", DJ: "Djibouti", DK: "Denmark",
      DM: "Dominica", DO: "Dominican Republic", DZ: "Algeria", EC: "Ecuador", EE: "Estonia",
      EG: "Egypt", EH: "Western Sahara", ER: "Eritrea", ES: "Spain", ET: "Ethiopia",
      FI: "Finland", FJ: "Fiji", FK: "Falkland Islands", FM: "Micronesia", FO: "Faroe Islands",
      FR: "France", GA: "Gabon", GB: "UK", GD: "Grenada", GE: "Georgia", GF: "French Guiana",
      GG: "Guernsey", GH: "Ghana", GI: "Gibraltar", GL: "Greenland", GM: "Gambia",
      GN: "Guinea", GP: "Guadeloupe", GQ: "Equatorial Guinea", GR: "Greece", GS: "South Georgia",
      GT: "Guatemala", GU: "Guam", GW: "Guinea-Bissau", GY: "Guyana", HK: "Hong Kong",
      HM: "Heard Island", HN: "Honduras", HR: "Croatia", HT: "Haiti", HU: "Hungary",
      ID: "Indonesia", IE: "Ireland", IL: "Israel", IM: "Isle of Man", IN: "India",
      IO: "British Indian Ocean Territory", IQ: "Iraq", IR: "Iran", IS: "Iceland",
      IT: "Italy", JE: "Jersey", JM: "Jamaica", JO: "Jordan", JP: "Japan", KE: "Kenya",
      KG: "Kyrgyzstan", KH: "Cambodia", KI: "Kiribati", KM: "Comoros", KN: "Saint Kitts",
      KP: "North Korea", KR: "South Korea", KW: "Kuwait", KY: "Cayman Islands", KZ: "Kazakhstan",
      LA: "Laos", LB: "Lebanon", LC: "Saint Lucia", LI: "Liechtenstein", LK: "Sri Lanka",
      LR: "Liberia", LS: "Lesotho", LT: "Lithuania", LU: "Luxembourg", LV: "Latvia",
      LY: "Libya", MA: "Morocco", MC: "Monaco", MD: "Moldova", ME: "Montenegro",
      MF: "Saint Martin", MG: "Madagascar", MH: "Marshall Islands", MK: "North Macedonia",
      ML: "Mali", MM: "Myanmar", MN: "Mongolia", MO: "Macao", MP: "Northern Mariana Islands",
      MQ: "Martinique", MR: "Mauritania", MS: "Montserrat", MT: "Malta", MU: "Mauritius",
      MV: "Maldives", MW: "Malawi", MX: "Mexico", MY: "Malaysia", MZ: "Mozambique",
      NA: "Namibia", NC: "New Caledonia", NE: "Niger", NF: "Norfolk Island", NG: "Nigeria",
      NI: "Nicaragua", NL: "Netherlands", NO: "Norway", NP: "Nepal", NR: "Nauru",
      NU: "Niue", NZ: "New Zealand", OM: "Oman", PA: "Panama", PE: "Peru", PF: "French Polynesia",
      PG: "Papua New Guinea", PH: "Philippines", PK: "Pakistan", PL: "Poland", PM: "Saint Pierre",
      PN: "Pitcairn", PR: "Puerto Rico", PS: "Palestine", PT: "Portugal", PW: "Palau",
      PY: "Paraguay", QA: "Qatar", RE: "Réunion", RO: "Romania", RS: "Serbia", RU: "Russia",
      RW: "Rwanda", SA: "Saudi", SB: "Solomon Islands", SC: "Seychelles", SD: "Sudan",
      SE: "Sweden", SG: "Singapore", SH: "Saint Helena", SI: "Slovenia", SJ: "Svalbard",
      SK: "Slovakia", SL: "Sierra Leone", SM: "San Marino", SN: "Senegal", SO: "Somalia",
      SR: "Suriname", SS: "South Sudan", ST: "São Tomé", SV: "El Salvador", SX: "Sint Maarten",
      SY: "Syria", SZ: "Eswatini", TC: "Turks and Caicos", TD: "Chad", TF: "French Southern Territories",
      TG: "Togo", TH: "Thailand", TJ: "Tajikistan", TK: "Tokelau", TL: "Timor-Leste",
      TM: "Turkmenistan", TN: "Tunisia", TO: "Tonga", TR: "Turkey", TT: "Trinidad",
      TV: "Tuvalu", TW: "Taiwan", TZ: "Tanzania", UA: "Ukraine", UG: "Uganda", UM: "US Outlying Islands",
      US: "USA", UY: "Uruguay", UZ: "Uzbekistan", VA: "Vatican City", VC: "Saint Vincent",
      VE: "Venezuela", VG: "British Virgin Islands", VI: "US Virgin Islands", VN: "Vietnam",
      VU: "Vanuatu", WF: "Wallis and Futuna", WS: "Samoa", YE: "Yemen", YT: "Mayotte",
      ZA: "South Africa", ZM: "Zambia", ZW: "Zimbabwe"
    };

    function codeToFlag(code) {
      if (!code) return "";
      return code.toUpperCase().replace(/./g, c => String.fromCodePoint(127397 + c.charCodeAt()));
    }

    let allGrouped = {};
    let allCountries = [];

    function renderOffers(filterCountry = null) {
      const offersDiv = document.getElementById("offers");
      offersDiv.innerHTML = "";
      Object.keys(allGrouped)
        .sort((a, b) => a.localeCompare(b))
        .forEach(key => {
          allGrouped[key].forEach((offer, index) => {
            if (filterCountry && offer.countryName.toLowerCase() !== filterCountry.toLowerCase()) return;
            const btn = document.createElement("a");
            btn.className = "btn";
            btn.href = offer.offer_url;
            btn.target = "_blank";
            btn.innerHTML = `<span class="flag">${offer.flag}</span> ${offer.countryName} (${offer.os}) (${index + 1})`;
            offersDiv.appendChild(btn);
          });
        });
    }

    function showAutocomplete(matches) {
      const box = document.getElementById("autocomplete");
      box.innerHTML = "";
      if (matches.length === 0) { box.style.display = "none"; return; }
      matches.forEach(country => {
        const div = document.createElement("div");
        div.className = "autocomplete-item";
        div.textContent = country;
        div.onclick = () => {
          document.getElementById("search").value = country;
          box.style.display = "none";
          renderOffers(country);
        };
        box.appendChild(div);
      });
      box.style.display = "block";
    }

    document.getElementById("search").addEventListener("input", e => {
      const val = e.target.value.toLowerCase();
      if (!val) { renderOffers(); document.getElementById("autocomplete").style.display = "none"; return; }
      const matches = allCountries.filter(c => c.toLowerCase().startsWith(val));
      showAutocomplete(matches);
    });

    document.getElementById("search").addEventListener("keydown", e => {
      if (e.key === "Enter") {
        const country = e.target.value;
        renderOffers(country);
        document.getElementById("autocomplete").style.display = "none";
      }
    });

    // Load JSON
    fetch("csvjson.json")
      .then(res => res.json())
      .then(data => {
        allGrouped = {};
        allCountries = [];

        data.forEach(offer => {
          const countryName = countryMap[offer.country_codes] || offer.country_codes;
          const flag = codeToFlag(offer.country_codes);

          // Normalize OS/device_type
          let os = offer.device_type;
          if (os.toLowerCase() === "ince") os = "Computer";
          if (os.toLowerCase() === "mobile_droid") os = "Android";
          if (os.toLowerCase() === "mobile_ios") os = "iOS";

          const key = countryName + " - " + os;
          if (!allGrouped[key]) allGrouped[key] = [];
          allGrouped[key].push({ ...offer, flag, countryName, os });

          if (!allCountries.includes(countryName)) allCountries.push(countryName);
        });

        renderOffers();
      });
  </script>
</body>
</html>
